#!/usr/bin/perl
use strict;
use warnings;

if ($#ARGV != 1) {
	print "Usage: ./snp <file> <regex command>\n";
	exit(1);
}
my $filename;
my $cmd;
if (-f $ARGV[0]) {
	$filename = \$ARGV[0];
	$cmd = \$ARGV[1];
} elsif (-f $ARGV[1]) {
	$filename = \$ARGV[1];
	$cmd = \$ARGV[0];
} else {
	print "Neither $ARGV[1] nor $ARGV[2] is a file\n";
	exit(1);
}
open(my $fh, '<', $$filename) or die "Can't open $$filename\n";
my $s;
while (<$fh>) {
	$s .= $_;
}
close($fh);
my $search = $$cmd;
$search =~ s/\/.*$//;
$search = qr/$search/;
my $replace = $$cmd;
$replace =~ s/^[^\/]*\///;
$replace =~ s/\/[^\/]*$//;
if ($$cmd =~ /\/[^\/]*\/g$/) {
	$s =~ s/$search/$replace/g;
} else {
	$s =~ s/$search/$replace/;
}
print "$s\n";
