#!/bin/sh
if [ "$(uname -s)" = Linux ]; then
	du -shc -- * 2>/dev/null | sort -h | less
else
du -sk -- * 2>/dev/null | sort -n |
	awk 'BEGIN {
			total = 0;
			kb = 1024;
			mb = kb * kb;
			gb = mb * kb;
		}
		{
			size = $1;
			name = $2;
			size *= 1024;
			total += size;
			if (kb > size)
				printf(fmt "%.1fB %s\n", size, name);
			else if (mb > size)
				printf(fmt "%.1fK %s\n", size/kb, name);
			else if (gb > size)
				printf(fmt "%.1fM %s\n", size/mb, name);
			else
				printf(fmt "%.1fG %s\n", size/gb, name);
		}
		END {
			printf("%.1fG total", total/gb);
		}' | less
fi
