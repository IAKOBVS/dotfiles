#!/bin/sh
. $HOME/.local/bin/scripts/vimvars
if test $1; then
	file=$(realpath $(echo "$@" | awk '{print $NF}') 2>/dev/null)
	dir=$(dirname $1)
	if [ -d $dir ]; then
		cd $dir || exec zsh
	fi
	if [ ! -f $file ]; then
		(fzf_update_dir $file &)
	fi
fi
$EDITOR $@ &&
case $(cat $__vim_msg__) in
*fzf*)
	. fzfvim
	;;
*lf*)
	. lfcd
	;;
esac
